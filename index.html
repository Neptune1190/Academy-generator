<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Rite Generator</title>
<style>
  body {
    font-family: monospace;
    background: #0e0e10;
    color: #f4f4f4;
    padding: 20px;
  }
  h2 { color: #ff5555; }
  label { display: block; margin-top: 10px; }
  input, select {
    width: 100%;
    padding: 6px;
    background: #1e1e22;
    color: #fff;
    border: 1px solid #333;
    border-radius: 5px;
  }
  button {
    margin-top: 15px;
    padding: 10px 20px;
    background: #ff5555;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }
  #copyBtn {
    background: #4caf50;
    margin-left: 10px;
  }
  #concludeBtn {
    background: #2196f3;
    margin-left: 10px;
  }
  textarea {
    width: 100%;
    height: 280px;
    margin-top: 15px;
    background: #1e1e22;
    color: #00ff9c;
    border: 1px solid #333;
    border-radius: 5px;
    padding: 10px;
  }
  .row {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
  }
  .row > div {
    flex: 1;
    min-width: 200px;
  }
</style>
</head>
<body>
  <h2>☰ Rite Format Generator ☰</h2>

  <label>Host (Discord ID or tag):</label>
  <input id="host" placeholder="<@320597836758777856>">

  <label>Rite Type:</label>
  <select id="rite">
    <option>Ascension Ceremony</option>
    <option>Korriban Excursion</option>
    <option>Rite of Advancement</option>
    <option>Rite of Lore</option>
    <option>Rite of Doctrine</option>
    <option>Rite of Passage</option>
  </select>

  <label>Server Name / Private Server Code:</label>
  <input id="server" placeholder="Server name or code">

  <label>Passed Members (separate with commas):</label>
  <input id="passed" placeholder="<@1111>, <@2222>">

  <div class="row">
    <div>
      <label>Start delay (minutes):</label>
      <input id="delay" type="number" min="0" value="10">
    </div>
    <div>
      <label>Timestamp style:</label>
      <select id="tsStyle">
        <option value="R">Relative (e.g. &lt;t:...:R&gt;)</option>
        <option value="f">Short (e.g. &lt;t:...:f&gt;)</option>
        <option value="F">Long (e.g. &lt;t:...:F&gt;)</option>
      </select>
    </div>
  </div>

  <div style="margin-top:15px;">
    <button id="generateBtn">Generate Message</button>
    <button id="copyBtn">Copy to Clipboard</button>
    <button id="concludeBtn">Conclude Rite</button>
  </div>

  <textarea id="output" readonly></textarea>

<script>
(function(){
  const roleMap = {
    "Ascension Ceremony": "<@&1151341324298092614>",
    "Korriban Excursion": "<@&1151341234615484439>",
    "Rite of Advancement": "<@&1150187179742609408>",
    "Rite of Lore": "<@&1150186944299536404>",
    "Rite of Doctrine": "<@&1150186946153418833>",
    "Rite of Passage": "<@&873072129816551427>"
  };

  const sithEmoji = "<:sith:1155672133838581860>";
  const output = document.getElementById('output');
  const generateBtn = document.getElementById('generateBtn');
  const copyBtn = document.getElementById('copyBtn');
  const concludeBtn = document.getElementById('concludeBtn');

  function buildHeader(rite) {
    const noPrefix = ["Ascension Ceremony", "Korriban Excursion"];
    const title = noPrefix.includes(rite)
      ? rite
      : `Rite of ${rite.replace(/^Rite of /i, "").trim()}`;
    return `☰  ${sithEmoji}   | ${title} |  ${sithEmoji}  ☰`;
  }

  function buildTimestamp(dateObj, style) {
    const secs = Math.floor(dateObj.getTime() / 1000);
    return `<t:${secs}:${style}>`;
  }

  function getCurrentDiscordTimestamp(style) {
    const now = new Date();
    return buildTimestamp(now, style);
  }

  generateBtn.addEventListener('click', () => {
    const host = (document.getElementById('host').value || "<@320597836758777856>").trim();
    const rite = (document.getElementById('rite').value || "Ascension Ceremony").trim();
    const server = (document.getElementById('server').value || "N/A").trim();
    const delayMinutes = Number(document.getElementById('delay').value || 10);
    const tsStyle = document.getElementById('tsStyle').value || "R";

    const location = (rite === "Korriban Excursion") ? "Korriban" : "Acolyte Barracks";
    const start = new Date(Date.now() + Math.max(0, delayMinutes) * 60 * 1000);
    const discordTimestamp = buildTimestamp(start, tsStyle);
    const header = buildHeader(rite);

    const content = [
      "╭─────────────────────────╮",
      `Host: ${host}`,
      `Location: ${location} | ${server}`,
      `Status: Pending`,
      `Passed: `,
      `Starting time: ${discordTimestamp}`,
      `Time of conclusion : `,
      `Note: Do not attend if you are on cooldown or at the rank of Youngling III+ in TJO.`,
      "╰─────────────────────────╯",
      roleMap[rite] || ""
    ].join("\n");

    output.value = header + "\n" + content;
  });

  concludeBtn.addEventListener('click', () => {
    if (!output.value.trim()) return alert("No message to conclude! Generate one first.");
    const tsStyle = document.getElementById('tsStyle').value || "R";
    const passed = document.getElementById('passed').value.trim();
    const conclusion = getCurrentDiscordTimestamp(tsStyle);

    let newOutput = output.value
      .replace(/Status: *Pending/i, "Status: Completed")
      .replace(/Time of conclusion *:.*$/m, `Time of conclusion : ${conclusion}`);

    if (passed) {
      newOutput = newOutput.replace(/Passed:.*$/m, `Passed: ${passed}`);
    }

    output.value = newOutput;
  });

  copyBtn.addEventListener('click', () => {
    if (!output.value.trim()) return alert("No message to copy! Generate one first.");
    output.select();
    document.execCommand("copy");
    copyBtn.textContent = "Copied!";
    setTimeout(() => copyBtn.textContent = "Copy to Clipboard", 1500);
  });
})();
</script>
</body>
</html>
